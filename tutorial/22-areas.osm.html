<!DOCTYPE html>
<html class="h-100" prefix="og: http://ogp.me/ns#">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>22 - Areas</title>

    <meta property="og:type" content="article" />
    <meta property="og:title" content="22 - Areas" />
    <meta property="og:description" content="A basic tutorial covering the key features of the Overpass language" />
    <meta property="og:image" content="../overpass-doc.png" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="22 - Areas" />
    <meta name="twitter:image" content="../../overpass-doc.png" />


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

    <link rel="stylesheet" href="../../codemirror.css">

    <script src="../../codemirror.js" type="text/javascript"></script>
    <script src="../../mode/clike/clike.js" type="text/javascript"></script>
    <script src="../../util/multiplex.js" type="text/javascript"></script>

    <style type="text/css">
      .CodeMirror {
        /* Bootstrap Settings */
        box-sizing: border-box;
        margin: 0;
        font: inherit;
        overflow: auto;
        font-family: inherit;
        display: block;
        width: 100%;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075); /* Bootstrap 3 */
        box-shadow: none; /* Bootstrap 4 */
        transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        /* Code Mirror Settings */
        font-family: monospace;
        position: relative;
        overflow: hidden;
        height: auto;
      }
      .CodeMirror-scrollbar {
        visibility: hidden;
      }
      .CodeMirror-focused {
        /* Bootstrap Settings */
        border-color: #66afe9;
        outline: 0;
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px rgba(102, 175, 233, .6); /* Bootstrap 3 */
        box-shadow: 0 0 0 .2rem rgba(0, 123, 255, .25); /* Bootstrap 4 */
        transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
      }
      .CodeMirror-scroll {
        height: 100%;
      }

      .bg-color {
        background-color: #e3f2fd;
      }
    </style>

  </head>

  <body class="d-flex flex-column h-100">
    <header>
        <nav class="navbar navbar-expand-md navbar-light bg-color">
            <a class="navbar-brand" href="/"><i class="bi bi-geo-fill"></i> OSM Queries</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
              <ul class="navbar-nav">
                
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      About
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      
                          <a class="dropdown-item" href="../background.html">Background</a>
            		  	  
                          <a class="dropdown-item" href="../contribute.html">Contribute</a>
            		  	  
                          <a class="dropdown-item" href="../licence.html">Licence</a>
            		  	  
                          <a class="dropdown-item" href="../colophon.html">Colophon</a>
            		  	  
                    </div>
                  </li>
        		  	
                
              </ul>
            </div>
        </nav>
    </header>

      <main class="pt-4">
       <div class="container-fluid">
  <div class="row">

    <div class="col-md-auto">
      
        <h5><a href="index.html" class="text-decoration-none">Overpass Tutorial</a></h5>
      

      

      
        <ul class="list-unstyled">
          
            <li class="" >
              <a href="00-node-1.osm.html">00 - The Beginning</a>
            </li>
          
            <li class="" >
              <a href="01-nodes.osm.html">01 - Finding nodes with a bounding box</a>
            </li>
          
            <li class="" >
              <a href="02-node-output.osm.html">02 - Outputting data about nodes</a>
            </li>
          
            <li class="" >
              <a href="03-nodes-basic-filter.osm.html">03 - Filtering nodes that have a tag</a>
            </li>
          
            <li class="" >
              <a href="04-nodes-has-kv.osm.html">04 - Find nodes by matching tags and their values</a>
            </li>
          
            <li class="" >
              <a href="05-nodes-combined-filter.osm.html">05 - Find nodes by applying multiple filters</a>
            </li>
          
            <li class="" >
              <a href="06-nodes-union.osm.html">06 - Extracting multiple sets of nodes</a>
            </li>
          
            <li class="" >
              <a href="07-nodes-differences.osm.html">07 - Calculating differences between results</a>
            </li>
          
            <li class="" >
              <a href="08-nodes-json-output.osm.html">08 - Generating JSON output</a>
            </li>
          
            <li class="" >
              <a href="09-nodes-csv-output.osm.html">09 - Generating CSV output</a>
            </li>
          
            <li class="" >
              <a href="10-the-default-set.osm.html">10 - The default set</a>
            </li>
          
            <li class="" >
              <a href="11-query-a-set.osm.html">11 - Querying a set</a>
            </li>
          
            <li class="" >
              <a href="12-radius-search.osm.html">12 - Searching within a radius using around</a>
            </li>
          
            <li class="" >
              <a href="13-around-with-set.osm.html">12 - Using around to filter against a set of results</a>
            </li>
          
            <li class="" >
              <a href="14-searching-by-polygon.osm.html">14 - Searching by polygon</a>
            </li>
          
            <li class="" >
              <a href="15-ways.osm.html">15 - Finding ways</a>
            </li>
          
            <li class="" >
              <a href="16-ways-and-their-nodes.osm.html">16 - Ways and their nodes</a>
            </li>
          
            <li class="" >
              <a href="17-ways-and-their-tags.osm.html">17 - Ways and their tags</a>
            </li>
          
            <li class="" >
              <a href="18-nodes-and-ways.osm.html">18 - Combining node and way queries</a>
            </li>
          
            <li class="" >
              <a href="19-find-ways-from-nodes.osm.html">19 - Finding ways from their nodes</a>
            </li>
          
            <li class="" >
              <a href="20-relations.osm.html">20 - Finding relations</a>
            </li>
          
            <li class="" >
              <a href="21-type-agnostic-queries.osm.html">21 - Type agnostic queries (nwr)</a>
            </li>
          
            <li class="bg-color" >
              <a href="22-areas.osm.html">22 - Areas</a>
            </li>
          
            <li class="" >
              <a href="23-areas-from-features.osm.html">23 - Finding the areas enclosing a feature</a>
            </li>
          
            <li class="" >
              <a href="24-mapToArea.osm.html">24 - Find the area derived from a feature</a>
            </li>
          
            <li class="" >
              <a href="25-areas-via-nominatim.osm.html">25 - Areas via Nominatim search</a>
            </li>
          
            <li class="" >
              <a href="26-timeouts-and-endpoints.osm.html">26 - Timeouts and endpoints</a>
            </li>
          
        </ul>
      
    </div>

    <div class="col-6">
      <div class="row">
        <div class="col">
          <h2 property="title">22 - Areas</h2>
        </div>
      </div>
      <div class="row">
        <div class="col">
					<textarea id="overpass" cols="120">
//find any area with this name
area["name"="Uluru-Kata Tjuta National Park"];
(
 //find any ways that are WITHIN that area, filtering them by their tag
 way(area)["natural"="bare_rock"];
 >;
);
out body;
</textarea>
          <div class="float-right">
            <a class="btn btn-success btn-sm" href="https://overpass-turbo.eu/?Q=%2F%2A%0AThis+query+finds+all+natural+rock+formations+within+Uluru-Kata+Tjuta+National+Park.%0AThe+results+include+Uluru%2C+Taputji+and+Mala+Kata.%0A%0ASo+far+we%27ve+written+queries+to+find+nodes%2C+ways+and+relations.+But+in+this+query%0Awe+are+using+a+new+statement%3A+%60area%60.%0A%0AAreas+are+interesting+in+that+they+are+not+formally+part+of+the+OSM+data+model.%0AThey+are+features+which+are+created+within+the+Overpass+API+database.+This+means+that%0Athey+can+be+queried+and+manipulated+via+the+API%2C+but+they%27re+not+something+you+can+edit.%0A%0AAreas+are+automatically+created+for+a+subset+of+ways+and+relations%2C+including%3A%0A%0A%2A+any+relation+with+a+%60type%60+of+%60multipolygon%60+and+a+%60name%60%0A%2A+any+relation+with+a+%60type%60+of+%60boundary%60+and+a+%60name%60%0A%2A+any+relation+that+has+an+%60admin_level%60+and+%60name%60+attribute%0A%2A+any+relation+with+a+%60postal_code%60+or+%60addr%3Apostcode%60%0A%2A+a+wide+range+of+different+named+ways+including+buildings%2C+highways%2C+natural+features%2C+leisure+areas%2C+places%2C+historic+and+tourism+areas%0A%0AA+definitive+list+can+be+found+in+the+links+below.%0A%0AAreas+then+are+a+subset+of+relations+and+ways.+From+a+query+perspective%2C+you%0Acan+think+of+them+like+other+elements.+For+example+in+this+query+we%27re+finding+an%0Aarea+based+on+its+name.%0A%0A%60%60%60%0Aarea%5B%22name%22%3D%22Uluru-Kata+Tjuta+National+Park%22%5D%0A%60%60%60%0A%0AThe+advantage+of+using+these+generated+features+over+the+original+ways+and+relations%0Ais+that+the+API+and+query+language+provides+some+additional+functionality+for+working+with+them.%0A%0AFor+example+in+this+query+we%27re+using+an+%60area%60+filter%2C+like+this%3A%0A%0A%60%60%60%0Away%28area%29%3B%0A%60%60%60%0A%0AThe+area+filter+will+restrict+the+ways+%28or+nodes%2C+or+relations%29+we%27re+interested+in%0Ato+those+that+are+within+an+area+we%27ve+already+found.+This+type+of+spatial+query%0Aisn%27t+available+using+either+ways+and+relations.+I+presume+this+is+to+limit+the+amount%0Aof+indexing+required+to+support+this+type+of+query.%0A%0AThe+area+query+and+the+area+filter+both+work+with+named+sets.+By+default+they+work%0Awith+the+default+set+%28%60_%60%29.+This+is+what+the+example+query+uses.%0A%0ABut+an+alternate+way+to+write+this+example+is+to+explicitly+store+the+area+we%27re%0Ainterested+in+a+named+set.+I+find+this+a+bit+clearer+in+practice.%0A%0AHere%27s+how+this+would+look%2C+using+a+named+set+called+%60ourArea%60%3A%0A%0A%60%60%60%0Aarea%5B%22name%22%3D%22Uluru-Kata+Tjuta+National+Park%22%5D-%3E.ourArea%3B%0A%28%0A+way%28area.ourArea%29%5B%22natural%22%3D%22bare_rock%22%5D%3B%0A+%3E%3B%0A%29%3B%0A%60%60%60%0A%0AIf+we+wanted+to+instead+find+nodes+or+relations+then+we+could+use+either+of+the%0Afollowing%3A%0A%0A%60%60%60%0Anode%28area.ourArea%29%3B%0Arelation%28area.ourArea%29%3B%0A%60%60%60%0A%0A%40see+http%3A%2F%2Fwww.indigenousaustralia.info%2Fthe-dreaming%2Frock-legends%2Ftaputji.html%0A%40see+https%3A%2F%2Fwiki.openstreetmap.org%2Fwiki%2FOverpass_API%2FAreas%0A%40see+https%3A%2F%2Fgithub.com%2Fdrolbr%2FOverpass-API%2Fblob%2Fmaster%2Fsrc%2Frules%2Fareas.osm3s%0A%40title+22+-+Areas%0A%2A%2F%0A%2F%2Ffind+any+area+with+this+name%0Aarea%5B%22name%22%3D%22Uluru-Kata+Tjuta+National+Park%22%5D%3B%0A%28%0A+%2F%2Ffind+any+ways+that+are+WITHIN+that+area%2C+filtering+them+by+their+tag%0A+way%28area%29%5B%22natural%22%3D%22bare_rock%22%5D%3B%0A+%3E%3B%0A%29%3B%0Aout+body%3B%0A&R" target="_blank">
                <i class="bi bi-play"></i>Run
            </a>
          </div>
					<script>
            CodeMirror.defineMIME("text/x-overpassQL", {
              name: "clike",
              keywords: (function (str) {
                var r = {};
                var a = str.split(" ");
                for (var i = 0; i < a.length; i++) r[a[i]] = true;
                return r;
              })(
                "out json xml custom popup timeout maxsize bbox" + // initial declarations
                  " date diff adiff" + //attic declarations
                  " foreach" + // block statements
                  " relation rel way node is_in area around user uid newer changed poly pivot nwr derived" + // queries
                  " out meta body skel tags ids count qt asc" + // actions
                  " center bb geom" // geometry types
                //+"r w n br bw" // recursors
              )
            });
            CodeMirror.defineMIME("text/x-overpassXML", "xml");
            CodeMirror.defineMode("xml+mustache", function (config) {
              return CodeMirror.multiplexingMode(
                CodeMirror.multiplexingMode(CodeMirror.getMode(config, "xml"), {
                  open: "{{",
                  close: "}}",
                  mode: CodeMirror.getMode(config, "text/plain"),
                  delimStyle: "mustache"
                }),
                {
                  open: "{{style:",
                  close: "}}",
                  mode: CodeMirror.getMode(config, "text/css"),
                  delimStyle: "mustache"
                }
              );
            });
            CodeMirror.defineMode("ql+mustache", function (config) {
              return CodeMirror.multiplexingMode(
                CodeMirror.multiplexingMode(
                  CodeMirror.getMode(config, "text/x-overpassQL"),
                  {
                    open: "{{",
                    close: "}}",
                    mode: CodeMirror.getMode(config, "text/plain"),
                    delimStyle: "mustache"
                  }
                ),
                {
                  open: "{{style:",
                  close: "}}",
                  mode: CodeMirror.getMode(config, "text/css"),
                  delimStyle: "mustache"
                }
              );
            });
					  var editor = CodeMirror.fromTextArea(document.getElementById("overpass"), {
						    autofocus: false,
						    readOnly: true,
                viewportMargin: Infinity,
                mode: "ql+mustache",
						    lineNumbers: true,
                lineWrapping: true,
                matchBrackets: true,
                closeTagEnabled: true,
                closeTagIndent: [
                  "osm-script",
                  "query",
                  "union",
                  "foreach",
                  "difference"
                ]
						  });
					</script>

        </div>
      </div>
      <div class="row">
        <div class="col">
          
						<p property="description"><p>This query finds all natural rock formations within Uluru-Kata Tjuta National Park.
The results include Uluru, Taputji and Mala Kata.</p>

<p>So far we&#39;ve written queries to find nodes, ways and relations. But in this query
we are using a new statement: <code>area</code>.</p>

<p>Areas are interesting in that they are not formally part of the OSM data model.
They are features which are created within the Overpass API database. This means that
they can be queried and manipulated via the API, but they&#39;re not something you can edit.</p>

<p>Areas are automatically created for a subset of ways and relations, including:</p>

<ul>
<li>any relation with a <code>type</code> of <code>multipolygon</code> and a <code>name</code></li>
<li>any relation with a <code>type</code> of <code>boundary</code> and a <code>name</code></li>
<li>any relation that has an <code>admin_level</code> and <code>name</code> attribute</li>
<li>any relation with a <code>postal_code</code> or <code>addr:postcode</code></li>
<li>a wide range of different named ways including buildings, highways, natural features, leisure areas, places, historic and tourism areas</li>
</ul>

<p>A definitive list can be found in the links below.</p>

<p>Areas then are a subset of relations and ways. From a query perspective, you
can think of them like other elements. For example in this query we&#39;re finding an
area based on its name.</p>

<p><code>
area[&quot;name&quot;=&quot;Uluru-Kata Tjuta National Park&quot;]
</code></p>

<p>The advantage of using these generated features over the original ways and relations
is that the API and query language provides some additional functionality for working with them.</p>

<p>For example in this query we&#39;re using an <code>area</code> filter, like this:</p>

<p><code>
way(area);
</code></p>

<p>The area filter will restrict the ways (or nodes, or relations) we&#39;re interested in
to those that are within an area we&#39;ve already found. This type of spatial query
isn&#39;t available using either ways and relations. I presume this is to limit the amount
of indexing required to support this type of query.</p>

<p>The area query and the area filter both work with named sets. By default they work
with the default set (<code>_</code>). This is what the example query uses.</p>

<p>But an alternate way to write this example is to explicitly store the area we&#39;re
interested in a named set. I find this a bit clearer in practice.</p>

<p>Here&#39;s how this would look, using a named set called <code>ourArea</code>:</p>

<p>```
area[&quot;name&quot;=&quot;Uluru-Kata Tjuta National Park&quot;]-&gt;.ourArea;
(
way(area.ourArea)[&quot;natural&quot;=&quot;bare_rock&quot;];</p>

<blockquote>
<p>;
);
```</p>
</blockquote>

<p>If we wanted to instead find nodes or relations then we could use either of the
following:</p>

<p><code>
node(area.ourArea);
relation(area.ourArea);
</code></p>
</p>
					

          <table class="table">
            <tbody>
              
                <tr>
                  <td>Links</td>
                  <td>
                    <ul class="list-unstyled">
                      
                           <li><a href="http://www.indigenousaustralia.info/the-dreaming/rock-legends/taputji.html">http://www.indigenousaustralia.info/the-dreaming/rock-legends/taputji.html</a></li>
                      
                           <li><a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Areas">https://wiki.openstreetmap.org/wiki/Overpass_API/Areas</a></li>
                      
                           <li><a href="https://github.com/drolbr/Overpass-API/blob/master/src/rules/areas.osm3s">https://github.com/drolbr/Overpass-API/blob/master/src/rules/areas.osm3s</a></li>
                      
                    </ul>
                  </td>
                </tr>
              
              <tr>
                <td>Source File</td><td><a href="22-areas.osm"><code>22-areas.osm</code></a></td>
              </tr>
              
                <tr>
                  <td>Authors</td>
                  <td>
                      <ul class="list-unstyled">
                        
            					       <li><span>Leigh Dodds</span></li>
            					  
                      </ul>
                  </td>
                </tr>
              
              
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>

      </main>

       <footer class="footer mt-auto py-3 bg-light">
         <div class="container">
           <span class="text-muted">Generated with <a href="http://github.com/ldodds/overpass-doc">overpass-doc</a>.</span>
         </div>
       </footer>


  </body>
</html>
